# include "reg51.h"
#include "intrins.h"
typedef unsigned char u8;
typedef unsigned int u16;

sbit SH_CP = P3^6;  //????????? ?????????????
sbit ST_CP = P3^5;  //??????? ??????????
sbit DS = P3^4;     //????
									 

void hc595sendbyte(u8 dat)
{
	u8 a;
	SH_CP= 0;
	ST_CP = 0;
	
	for(a =0;a<8;a++)
	{
	  DS = dat >> 7; //??????
	  dat <<=1; 
	  SH_CP = 1;
	  _nop_();  //????????
	  _nop_();  //
	  SH_CP = 0;
	}
	ST_CP = 1;   //???????
	_nop_();
	_nop_();
	ST_CP = 0;
}

int main()
{
	hc595sendbyte(0x80);
	P0 = 0x7f;
	while(1);
	 
}